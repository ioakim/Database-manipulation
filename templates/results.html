<!DOCTYPE html>
<head>
    <title>
    Database UI
    </title>
</head>
<body>
    
	{# THIS SECTION IS FOR THE SUMMARY REPORT #}
    {% if books|length > 0 %}
        <!--Create table for summary report-->
        <h1> Summary </h1>
        <table border="1">
            <tr>
                <th>
					Name
                </th>
                <th>
					Number of books
                </th>
                <th>
					Average Price
                </th>
            </tr>
            {% for row in books %}
            <tr>
                <td>
					{{row['categ_name']}}
                </td>
                <td>
					{{row['book_count']}}
                </td>
                <td>
					{% if row['avg_price'] == None %}
						£0
					{% else %}
						£{{row['avg_price']}}
					{% endif %}
                </td>
            </tr>
            {% endfor %}
        </table><br/>
        
		<h1> Totals </h1>
        <table border="1">
            <tr>
                <th>
					Total of categories
                </th>
                <th>
					Total of books
                </th>
                <th>
					Total of prices
                </th>
            </tr>
            {% for row in totals %}
            <tr>
                <td>
					{{row['categ_count']}}
                </td>
                <td>
					{{row['book_count']}}
                </td>
                <td>
					£{{row['price_sum']}}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% endif %}


    {# THIS SECTION IS FOR THE PUBLISHER REPORT #}
	{% if publisher|length > 0 %}
        <!--Create table for summary report-->
        <h1> Publisher Activity </h1>
        <table border="1">
            <tr>
                <th>
					Book ID
                </th>
                <th>
					Book title
                </th>
				<th>
					Date
                </th>
                <th>
					Total orders
                </th>
				<th>
					Total quantity
                </th>
				<th>
					Total order value
                </th>
				<th>
					Total retail value
                </th>
			</tr>
            {% for row in publisher %}
            <tr>
                <td>
					{{row['book_id']}}
                </td>
                <td>
					{{row['title']}}
                </td>
				<td>
					{{row['month']|int}} - {{row['year']|int}}
                </td>
				<td>
					{{row['total_orders']}}
                </td>
				<td>
					{{row['total_qty']}}
                </td>
				<td>
					£{{row['totalsellingprice']}}
                </td>
				<td>
					£{{row['totaloriginalprice']}}
                </td>
            </tr>
            {% endfor %}
        </table><br/>
	{% endif %}
	
	{# THIS SECTION IS FOR THE BOOK ORDER HISTORY #}
    {% if history|length > 0 %}
        <!--Create table for summary report-->
        <h1> Order History </h1>
        <table border="1">
            <tr>
                <th>
					Date
                </th>
                <th>
					Book Title
                </th>
                <th>
					Book Price
                </th>
				<th>
					Quantity
                </th>
				<th>
					Selling Price
                </th>
				<th>
					Order Value
                </th>
				<th>
					Shop
                </th>
            </tr>
            {% for row in history %}
            <tr>
                <td>
					{{row['date']}}
                </td>
                <td>
					{{row['title']}}
                </td>
				<td>
					£{{row['price']}}
                </td>
				<td>
					{{row['qty']}}
                </td>
				<td>
					£{{row['selling_price']}}
                </td>
				<td>
					£{{row['order_value']}}
                </td>
                <td>
					{{row['shop']}}
                </td>
            </tr>
            {% endfor %}
        </table><br/>
        
		<h1> Totals </h1>
        <table border="1">
            <tr>
                <th>
					Total copies ordered
                </th>
                <th>
					Total selling value
                </th>
            </tr>
            {% for row in totals %}
            <tr>
                <td>
					{{row['total_qty']}}
                </td>
                <td>
					£{{row['total_value']}}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% endif %}
	
	{# THIS SECTION IS FOR THE SALES REP REPORT #}
	{% if performance|length > 0 %}
        <!--Create table for summary report-->
        <h1> Sales Representative Performance </h1>
        <table border="1">
            <tr>
                <th>
					Sales Rep ID
                </th>
                <th>
					Total units sold
                </th>
				<th>
					Total order value
                </th>
			</tr>
            {% for row in performance %}
            <tr>
                <td>
					{{row['salesrep_id']}}
                </td>
				<td>
					{{row['total_sales']}}
                </td>
				<td>
					£{{row['total_value']}}
                </td>
            </tr>
            {% endfor %}
        </table><br/>
	{% endif %}
	
    <form action="/">
        <input type="submit" value="Back home">
    </form>

</body>
</html>